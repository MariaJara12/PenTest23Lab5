 <?php

    //This is the source code to understand the vulnerability in the cross site scripting of http://10.0.2.4/dvwa 
  
    if (isset($_GET['Change'])) {
    
	// Turn requests into variables
	// variables used within the url 
        $pass_new = $_GET['password_new'];
        $pass_conf = $_GET['password_conf'];

	//when $pass_new and $pass_conf are the same, the new password is updated on the table 

        if (($pass_new == $pass_conf)){
            $pass_new = mysql_real_escape_string($pass_new);
            $pass_new = md5($pass_new);

            $insert="UPDATE `users` SET password = '$pass_new' WHERE user = 'admin';";
            $result=mysql_query($insert) or die('<pre>' . mysql_error() . '</pre>' );

	    //password successfully changed 
            echo "<pre> Password Changed </pre>";        
            mysql_close();
        }
    
        else{        
            echo "<pre> Passwords did not match. </pre>";            
        }

    }
?>



