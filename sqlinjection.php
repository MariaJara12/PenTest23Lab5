<?php    

//This is the source code to understand the vulnerability for SQL injections on 
//http://10.0.2.4/dvwa 

//To exploit the vulnerability, type SQL commands on the User ID bar 

if(isset($_GET['Submit'])){
    
    // Retrieve data

    //this causes the system to out the info for any given "id" command 
    $id = $_GET['id'];

    $getid = "SELECT first_name, last_name FROM users WHERE user_id = '$id'";
    $result = mysql_query($getid) or die('<pre>' . mysql_error() . '</pre>' );

    $num = mysql_numrows($result);

    $i = 0;

    while ($i < $num) {

        $first = mysql_result($result,$i,"first_name");
        $last = mysql_result($result,$i,"last_name");
        
        echo '<pre>';
        echo 'ID: ' . $id . '<br>First name: ' . $first . '<br>Surname: ' . $last;
        echo '</pre>';

        $i++;
    }
}
?>
